<html>

<head>
     <title>Place Your Favorite Christmas Movie Quote</title>
</head>

<body>
    <div>
        <!--Large Christmas title screen-->

    </div>
    <div>
        <!--Movie and quote entry-->
        <label for="movieTitle">Movie Title</label>
        <input type="text" id="movieEntry" name="Christmas Movie Name" required size="25">
        <br>
        <label for="movieQuote">Movie Quote</label>
        <textarea id="quoteEntry" name="Christmas Movie Quote" rows="5" cols="35"> </textarea>
    </div>
    <div>
        <!--Contestant name and Country entry-->
        <p>Enter your name and Nation</p>
        <label for="contestantName">Your Name</label>
        <input type="text" id="contestantNameEntry" name="ContestantName" required size="25">
        <div>
            <input type="radio" id="digitaly" name="contestantNation" value="dig">
            <label for="nations">Digitaly</label>
            <br>
            <input type="radio" id="developmentopia" name="contestantNation" value="dev">
            <label for="nations">Developmentopia</label>
            <br>
            <input type="radio" id="unitedServices" name="contestantNation" value="us">
            <label for="nations">United Services</label>
            <br>
            <input type="radio" id="supportLandia" name="contestantNation" value="sup">
            <label for="nations">Supportlandia</label>
            <br>
            <input type="radio" id="procuristan" name="contestantNation" value="pro">
            <label for="nations">Procuristan</label>            
        </div>
    </div>
    <div>
        <!--Submit and cancel buttons-->
        <button type="button" onclick="getMovie()"> Submit</button>
        <button type="button" onclick="clearForm()"> Cancel</button>
    </div>
     
    <script>

        var movieQuoteData = {
            contestantName: "",
            contestantNation: "",
            movieTitle: "",
            movieQuote: "",
            movieQuotePts: 0,
            movieRank: "",
            movieImage: ""
        };

        const ChristmasMovieQuote = "ChristmasMovieQuote";
        const ChristmasMovieLBDisplay = "ChristmasMovieLBDisplay";
        const ChristmasMovieQuoteDisplay = "ChristmasMovieQuoteDisplay";
        const ChristmasMovieTitleScreen = "ChristmasMovieTitleScreen";
        const nextScreenArray = [ChristmasMovieLBDisplay, ChristmasMovieQuoteDisplay, ChristmasMovieTitleScreen];
        const LEADER_BOARD = "leaderBoard";
        const MOVIE_QUOTES = "movieQuotes"
        const cfgLeaderBoardNum = 10000;
        const cfgActivityTimeOut = 180000;
        const cfgScreenSwaps = 60000;
        const cfgQuoteSwap = 10000;
        var currentScreen = 0;

        function getMovie() {
            movieQuoteData.movieTitle = document.getElementById("movieEntry").value;
            movieQuoteData.movieQuote = document.getElementById("quoteEntry").value;
            movieQuoteData.contestantName = document.getElementById("contestantNameEntry").value;
            movieQuoteData.contestantNation = getRadioValue("contestantNation");
            if (document.getElementById("movieEntry").value &&
                document.getElementById("quoteEntry").value &&
                document.getElementById("contestantNameEntry").value) {
                writeMovieQuote();
                addToMovieQuotes(movieQuoteData);
            }
            else {
                clearForm();
            }
        }

        function getRadioValue(name) {
            var radioList = document.getElementsByName(name);
            for (let i = 0; i < radioList.length; i++) {
                if (radioList[i].checked) {
                    return radioList[i].value;
                }
            }
        }

        function writeMovieQuote() {
            document.write("<h2>Your favorite movie and quote:</h2>");
            for (var property in movieQuoteData) {
                if (movieQuoteData.hasOwnProperty(property)) {
                    document.write(property + ": " + movieQuoteData[property] + "<br>");
                }
            }
        }

        function clearForm() {
            document.getElementById("movieEntry").value = "";
            document.getElementById("quoteEntry").value = "";
            document.getElementById("contestantNameEntry").value = "";
            var radioList = document.getElementsByName("contestantNation");
            for (let i = 0; i < radioList.length; i++) {
                if (radioList[i].checked) {
                    radioList[i].checked = false;
                }
            }
        }

        function calculateLeaderBoardPosition(newUserQuoteData) {
            /** todo 
             *  getLeaderBoard
             *  qualifyForLeaderBoard
             *  addToLeaderBoard
             */
            addToLeaderBoard(newUserQuoteData).qualifyForLeaderBoard(newUserQuoteData).getLeaderBoard();
        }

        function getLeaderBoard() {
            /* Retreive the Leader Board from local storage */
            var leaderBoard = localStorage.getItem(LEADER_BOARD);
        }

        function qualifyForLeaderBoard(leader, user) {
            var leaderBoardData = localStorage.getItem(LEADER_BOARD);
        }

        function addToLeaderBoard(user) {
            var leaderBoard = localStorage.getItem(LEADER_BOARD);
            var userData = JSON.stringify(user);
            leaderBoard += userData;
            localStorage.setItem(LEADER_BOARD, leaderBoard);
        }

        function addToMovieQuotes(user) {
            var quoteRepository = localStorage.getItem(MOVIE_QUOTES);
            var userData = JSON.stringify(user);
            quoteRepository += userData;
            localStorage.setItem(MOVIE_QUOTES, quoteRepository);
        }

        function goVote(){
            
        }

        function screenSwap(){
            swapTimer = Date.getTime();
            while(swapTimer < swapTimer+cfgScreenSwaps){
                //wait till time to switch to next screen
            }
            document.location.href=nextScreenArray[currentScreen]+".htm";
        }
    </script>
</body>

</html>